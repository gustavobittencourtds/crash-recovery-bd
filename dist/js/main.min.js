dashboard={diskData:[{id:1,nome:"Maria",salario:2e3},{id:2,nome:"Carlos",salario:1500},{id:3,nome:"Paola",salario:2200},{id:4,nome:"Emília",salario:1800},{id:5,nome:"Otávio",salario:1400}],logMemoryData:[],bufferMemoryData:[],logDisk:[],insertTable:function(a,e,t){const o=[...t.reduce((e,a)=>(Object.keys(a).forEach(a=>e.add(a)),e),new Set)];var r=o.map(a=>`<th>${a}</th>`).join(""),t=t.map(e=>o.map(a=>`<td>${e[a]}</td>`).join("")).map(a=>`<tr>${a}</tr>`).join("");a.innerHTML=`<table><caption class="title">${e}</caption><thead><tr>${r}</tr></thead> <tbody>${t}</body></table>`},executeTransaction:function(){const a=document.querySelectorAll("[data-transaction]"),s=document.querySelector("[data-memory-log]"),c=document.querySelector("[data-memory-buffer]");0<a.length&&a.forEach(t=>{const d=t.querySelector(".sql"),a=(d.addEventListener("submit",a=>{a.preventDefault();const e=d.querySelector('input[name="where"]')?.value,t=d.querySelector('input[name="comparison"]')?.value,o=Number(d.querySelector('input[name="set_value"]')?.value),r=dashboard.diskData.find(a=>a[e]==t),n=r.salario,i={...r,salario:o};a={Transaction:"Transação "+d.querySelector('input[name="transaction_number"]').value,Tabela:"Funcionário",Linha:t,Atributo:"Salário",Antes:n,Depois:o,Status:"Início"};dashboard.logMemoryData.push(a),dashboard.bufferMemoryData.push(i),this.insertTable(s,"Memória - Buffer LOG",dashboard.logMemoryData),this.insertTable(c,"Memória - Buffer Dados",dashboard.bufferMemoryData),d.reset()}),t.querySelector("[data-commit]"));a.addEventListener("click",a=>{t.dataset.transaction="Fim";var e=dashboard.logMemoryData.map(a=>a.Transaction==t.dataset.name?{...a,Status:"Final"}:a);dashboard.logMemoryData=e,this.insertTable(s,"Memória - Buffer LOG",dashboard.logMemoryData)})})},checkpoint:function(){const t=this,a=document.querySelector("[data-checkpoint]");a.addEventListener("click",()=>{var a=document.querySelector("[data-disk]"),e=document.querySelector("[data-disk-data]"),a=(t.insertTable(a,"Disco - LOG",dashboard.logMemoryData),dashboard.logDisk=dashboard.logMemoryData,dashboard.diskData.map(e=>{var a=dashboard.bufferMemoryData.find(a=>a.id===e.id);return a||e}));dashboard.diskData=a,t.insertTable(e,"Disco - Dados",a)})},recovery:function(){const a=document.querySelectorAll("[data-transaction]");0<a.length&&a.forEach(a=>{})},init:function(){var a=document.querySelector("[data-disk-data]");this.insertTable(a,"Disco - Dados",dashboard.diskData),this.executeTransaction(),this.checkpoint()}},window.addEventListener("DOMContentLoaded",()=>{dashboard.init()});